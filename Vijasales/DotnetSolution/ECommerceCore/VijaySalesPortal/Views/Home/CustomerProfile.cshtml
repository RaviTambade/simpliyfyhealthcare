@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
}
<link rel="stylesheet" href="../contrast-bootstrap-pro/css/bootstrap.min.css" />
<link rel="stylesheet" href="../contrast-bootstrap-pro/css/cdb.css" />
<link href="~/Content/bootstrap.min.css" rel="stylesheet" type="text/css" />
<script src="~/lib/jquery/dist/jquery.min.js"></script>
<script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js" type="text/javascript"></script>
<script src="https://kit.fontawesome.com/9d1d9a82d2.js" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.js"></script>

<h2>User Profile</h2>
<br />

@* <div id="FirstRow">
    <input class="btn btn-info" type="button" id="btnOrderHistory" value="Order History" />
    <input class="btn btn-info" type="button" id="btnAccountDetails" value="Account Details" />
    <input class="btn btn-info" type="button" id="btnPaymentHistory" value="Payment History" />
    <input class="btn btn-info" type="button" id="btnLogout" value="Logout" />
    </div> *@
<div id="DivAccountDetails" style="margin-top:50px;">
    <form>
        <table>
            <tr>
                <td>User Id</td>
                <td><input type="number" name="UserId" id="txtUserId" /></td>


            </tr>
            <tr>
                <td>First Name</td>
                <td><input type="text" name="FirstName" id="txtUserFirstName" /></td>


            </tr>
            <tr>
                <td>Last Name</td>
                <td><input type="text" name="lastname" id="txtUserLastName" /> </td>


            </tr>
            <tr>
                <td>Email</td>
                <td><input type="email" name="email" id="UserEmail" /> </td>


            </tr>
            <tr>
                <td>Password</td>
                <td><input type="password" name="password" id="UserPassword" /></td>


            </tr>
            <tr>
                <td>Address</td>
                <td><input type="text" name="address" id="UserAddress" /></td>


            </tr>
            <tr>
                <td>Conatct No </td>
                <td><input type="tel" name="contactno" id="UserContact" /></td>


            </tr>
            <tr>
                <td>Role </td>
                <td><input type="text" name="role" id="UserRole" /></td>


            </tr>



            <tr>
               
                <td><button type="button" id="CloseDetails">Close</button></td>
                
            </tr>

        </table>
    </form>
</div>

<!-- Order History Chart -->


<!-- Account Settings Section -->
<div class="d-flex flex-column flex-shrink-0 p-3 bg-light" style="width: 280px;height:100vh;">
    <a href="/" class="d-flex align-items-center mb-3 mb-md-0 me-md-auto link-dark text-decoration-none">

        <span class="fs-4">Sidebar</span>
    </a>
    <hr>
    <ul class="nav nav-pills flex-column mb-auto">
        <li class="nav-item">
            <button class="nav-link btn btn-link active" id="btnAccountDetails" aria-current="page" onclick="setActive(this)">
                Customer Details
            </button>
        </li>
        <li>
            <button class="nav-link btn btn-link " id="btnOrderHistory" onclick="setActive(this)">
                Order History
            </button>
        </li>
        <li>
            <button class="nav-link btn btn-link " onclick="setActive(this)">
                Orders Chart
            </button>
        </li>
        <li>
            <button class="nav-link btn btn-link " onclick="setActive(this)">
                Edit Profile
            </button>
        </li>

    </ul>
    <hr>

</div>

<div class="col-md-6" style="margin-top:50px;">
   
    <div id="CustomerUpdateDetails" style="margin-top:50px;">
        <form class="row g-3">
            <div class="col-md-4">
                <label for="UserId" class="form-label"> User Id</label>
                <input type="number" class="form-control" id="txtCustomerId" placeholder="User Id ">
            </div>
            <div class="col-md-6">
                <label for="txtFirstName" class="form-label">First Name</label>
                <input type="text" class="form-control" id="txtFirstName" placeholder="First Name">
            </div>
            <div class="col-md-6">
                <label for="txtLastName" class="form-label">Last Name</label>
                <input type="text" class="form-control" id="txtLastName" placeholder="Last Name">
            </div>
            <div class="col-md-6">
                <label for="txtUserEmail" class="form-label">Email</label>
                <input type="email" class="form-control" id="txtUserEmail" placeholder="Email">
            </div>
            <div class="col-md-6">
                <label for="txtUserPassword" class="form-label">Password</label>
                <input type="password" class="form-control" id="txtUserPassword" placeholder="Password">
            </div>
            <div class="col-12">
                <label for="txtUserAddress" class="form-label">Address</label>
                <input type="text" class="form-control" id="txtUserAddress" placeholder="Apartment, studio, or floor">
            </div>
            <div class="col-md-4">
                <label for="ContactNumber" class="form-label">Contact Number</label>
                <input type="tel" class="form-control" id="ContactNumber" placeholder="Contact No">
            </div>
            <div class="col-md-4">
                <label for="CustomerRole" class="form-label">Select User Role</label>
                <select id="CustomerRole" class="form-select">
                    <option selected>Customer</option>
                    <option>Sales</option>
                </select>
            </div>
            <div class="col-12">
                <button type="submit" class="btn btn-info" id="SubmitEditedProfile">Edit</button>
            </div>
        </form>
    </div>
    
</div>

   

<div id="OrderChart" class="card chart-container" style="margin-top:30px;">
    <canvas id="chart"></canvas>
    <div id="CloseChart" style="margin-top:10px;">
        <input class="btn btn-info" type="button" id="btnLogout" value="Close" />
    </div>
</div>

<style>
    .chart-container {
        width: 50%;
        height: 50%;
        margin: auto;
    }
</style>

<script>
    $(document).ready(() => {
        $("#OrderChart").hide();
        $("#CustomerUpdateDetails").hide();
        $("#chart").hide();
        $("#DivAccountDetails").hide();

        $("#ChartVisuals").click(() => {
            $("#OrderChart").show();
            $("#chart").show();
           
        });
        $("#CloseChart").click(() => {
            $("#OrderChart").hide();
            $("#chart").hide();

        });

        $("#btnLogout").click(() => {
            alert("Logout button clicked.");
        });

        $("#EditProfile").click(() => {
            $("#DeleteAccount").hide();
            $("#ChartVisuals").hide();
            $("#CustomerUpdateDetails").show();
            $.ajax({
                url: 'http://localhost:5218/api/Users/2',
                type: "GET",
                contentType: "application/json",
                success: (user) => {
                    console.log(user);
                    $("#txtCustomerId").val(user.id);
                    $("#txtFirstName  ").val(user.firstName);
                    $("#txtLastName  ").val(user.lastName);
                    $("#txtUserEmail ").val(user.email);
                    $("#txtUserPassword").val(user.password);
                    $("#txtUserAddress").val(user.address);
                    $("#ContactNumber").val(user.contactNumber);
                    $("#CustomerRole").val(user.role);
                    console.log(user);

                }
            });

            
        });

        $("#SubmitEditedProfile").click(() => {
            $("#DeleteAccount").show();
            $("#ChartVisuals").show();
            $("#CustomerUpdateDetails").hide();
            let UserToUpdate = {
                id: $("#txtCustomerId").val(),
                firstName: $("#txtfirstName  ").val(),
                lastName: $("#txtLastName  ").val(),
                email: $("#txtUserEmail ").val(),
                password: $("#txtUserPassword").val(),
                address: $("#txtUserAddress").val(),
                contactNumber: $("#ContactNumber").val(),
                role: $("#CustomerRole ").val(),
            };
            $.ajax({
                url: 'http://localhost:5218/api/Users',
                type: "PUT",
                contentType: "application/json",
                data: JSON.stringify(UserToUpdate),
                success: () => {
                    console.log("user updated!!");

                }
            });
        });
        $("#btnAccountDetails").click(() => {
            $("#DivAccountDetails").show();
          
                $.ajax({
                url: 'http://localhost:5218/api/Users/2',
                    type: "GET",
                    contentType: "application/json",
                    success: (user) => {
                        console.log(user);
                        $("#txtUserId").val(user.id);
                        $("#txtUserFirstName").val(user.firstName);
                        $("#txtUserLastName ").val(user.lastName);
                        $("#UserEmail       ").val(user.email);
                        $("#UserPassword    ").val(user.password);
                        $("#UserAddress     ").val(user.address);
                        $("#UserContact     ").val(user.contactNumber);
                        $("#UserRole        ").val(user.role);
                        console.log(user);

                    }
                });
           
            
        });
        $("#CloseDetails").click(() => {
            $("#DivAccountDetails").hide();
        });
        
       
        // Chart.js integration
        const ctx = document.getElementById("chart").getContext('2d');
        const myChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: ["Jan", "Feb", "March", "April", "May", "June", "July"],
                datasets: [{
                    label: 'Last week',
                    backgroundColor: 'rgba(161, 198, 247, 1)',
                    borderColor: 'rgb(47, 128, 237)',
                    data: [3000, 4000, 2000, 5000, 8000, 9000, 2000],
                }]
            },
            options: {
                scales: {
                    yAxes: [{
                        ticks: {
                            beginAtZero: true,
                        }
                    }]
                }
            },
        });
    });
    
        // Function to set the active class to the clicked button
        function setActive(button) {
            // Remove 'active' class from all buttons
            const buttons = document.querySelectorAll('.nav-link');
            buttons.forEach(btn => btn.classList.remove('active'));

            // Add 'active' class to the clicked button
            button.classList.add('active');
        }
</script>